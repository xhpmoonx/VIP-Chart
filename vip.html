<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
            <title>Curriculum Graph - VIP Course</title>
                <style>
                    body {
                    font-family: system-ui, sans-serif;
                    background: #f8fafc;
                    padding: 40px;
                    }

                    .grid {
                    display: grid;
                    grid-template-columns: repeat(8, 200px);
                    grid-template-rows: auto repeat(7, 100px) auto;
                    gap: 20px;
                    position: relative;
                    width: max-content;
                    }

                    .term-header {
                    text-align: center;
                    font-weight: bold;
                    color: #0f172a;
                    font-size: 1.2em;
                    grid-row: 1;
                    }

                    .term-footer {
                    font-size: 0.9em;
                    color: #475569;
                    text-align: center;
                    grid-row: 6;
                    }

                    .course {
                    background: transparent;
                    box-shadow: none;
                    border-radius: 0;
                    padding: 0;
                    z-index: 2;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    justify-content: center;
                    }


                    .circle {
                    width: 30px;
                    height: 30px;
                    border-radius: 50%;
                    background: yellow;
                    border: 3px solid #ef4444;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-weight: bold;
                    margin-bottom: 6px;
                    }

                    .label {
                    font-size: 0.85em;
                    color: #0f172a;
                    text-align: center;
                    }

                    svg {
                    position: absolute;
                    top: 0;
                    left: 0;
                    z-index: 10;
                    pointer-events: none; /*auto*/
                    }

                    .arrow {
                    stroke: #ef4444;
                    stroke-width: 2.5;
                    fill: none;
                    /*marker-end: url(#arrow);*/
                    }
                    .course:hover .circle {
                        border-color: #3b82f6;
                        box-shadow: 0 0 8px rgba(59, 130, 246, 0.5);
                    }

                    .arrow {
                        transition: stroke 0.2s ease, opacity 0.2s ease;
                        opacity: 0.3;
                    }

                    .arrow.highlighted {
                        stroke: #3b82f6;
                        opacity: 1;
                    }
                    /* dim all arrows/courses when a focus is active */
                    .grid.dimmed .course:not(.active) .circle {
                    border-color: #94a3b8;
                    background: #f1f5f9;
                    color: #94a3b8;
                    opacity: 0.3;
                    box-shadow: none;
                    }

                    .grid.dimmed .arrow:not(.highlighted) {
                    opacity: 0.1;
                    }

                    .course.active .circle {
                    border-color: #3b82f6;
                    background: yellow;
                    box-shadow: 0 0 8px rgba(59, 130, 246, 0.5);
                    }
                    .popup {
                    position: absolute;
                    background: white;
                    border: 1px solid #cbd5e1;
                    border-radius: 8px;
                    padding: 10px 14px;
                    font-size: 0.85em;
                    color: #0f172a;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
                    pointer-events: none;
                    z-index: 20;
                    display: none;
                    white-space: nowrap;
                    }

                    .layout {
                      display: grid;
                      grid-template-columns: 1fr 200px;
                      height: 100vh;
                      overflow: hidden;
                    }

                    .main-content {
                      overflow: auto;
                      padding: 40px;
                      position: relative;
                    }

                    .key {
                      background: white;
                      border-left: 1px solid #e2e8f0;
                      padding: 20px;
                      font-size: 0.9em;
                      color: #0f172a;
                      box-shadow: -2px 0 8px rgba(0,0,0,0.04);
                      height: 100%;
                      position: relative;
                      z-index: 10;
                    }


                  .key h3 {
                    margin-top: 0;
                    font-size: 1em;
                    margin-bottom: 8px;
                  }

                  .key ul {
                    list-style: none;
                    padding: 0;
                    margin: 0;
                  }

                  .key li {
                    display: flex;
                    align-items: center;
                    margin-bottom: 6px;
                  }

                  .key .circle.example {
                    width: 22px;
                    height: 22px;
                    font-size: 0.8em;
                    margin-right: 10px;
                    background: yellow;
                    border: 2px solid #ef4444;
                  }

                  .key-line {
                    display: inline-block;
                    width: 30px;
                    height: 3px;
                    margin-right: 10px;
                    background: #ef4444;
                  }

                  .key-line.prereq {
                    opacity: 0.3;
                  }

                  .key-line.blocked {
                    background: #3b82f6;
                  }

                  .key-line.all {
                    background: #475569;
                  }

                </style>
    </head>
<body>

  <div class="layout">
    <div class="main-content">
  
      <div id="popup" class="popup"></div>
      <div class="grid" id="curriculum">
        <svg id="svg" width="1000" height="800">
          <defs>
            <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5"
            markerWidth="4" markerHeight="4" orient="auto">
            <!-- <path d="M0 0 L10 5 L0 10" fill="none" stroke="#ef4444" stroke-width="1.5"/> -->
            </marker>
          </defs>
        </svg>
    
        <!-- TERM 1 -->
        <div class="term-header" style="grid-column: 1;">Fall</div>
        <div class="course" id="math101" style="grid-column: 1; grid-row: 2;">
          <div class="circle">4</div>
          <div class="label">MATH 101<br>Calculus I</div>
        </div>
        <div class="course" id="engr101" style="grid-column: 1; grid-row: 3;">
          <div class="circle">4</div>
          <div class="label">ENGR 101<br>Intro to Eng</div>
        </div>
        <div class="course" id="ge1" style="grid-column: 1; grid-row: 4;">
          <div class="circle">4</div>
          <div class="label">GE 1<br>Writing</div>
        </div>
        <div class="course" id="ge-math" style="grid-column: 1; grid-row: 5;">
          <div class="circle">4</div>
          <div class="label">GE MATH<br>Reasoning</div>
        </div>
        <div class="course" id="ge-hist" style="grid-column: 1; grid-row: 6;">
          <div class="circle">4</div>
          <div class="label">GE HIST<br>US History</div>
        </div>
        
        <div class="term-footer" style="grid-column: 1; grid-row: 7;">Units: 20 | Complexity: 95</div>
    
        <!-- TERM 2 -->
        <div class="term-header" style="grid-column: 2;">Winter</div>
        <div class="course" id="phys101" style="grid-column: 2; grid-row: 2;">
          <div class="circle">4</div>
          <div class="label">PHYS 101<br>Physics I</div>
        </div>
        <div class="course" id="cs101" style="grid-column: 2; grid-row: 3;">
          <div class="circle">4</div>
          <div class="label">CS 101<br>Intro to CS</div>
        </div>
        <div class="course" id="ge2" style="grid-column: 2; grid-row: 4;">
          <div class="circle">4</div>
          <div class="label">GE 2<br>Ethics</div>
        </div>
        <div class="course" id="bio101" style="grid-column: 2; grid-row: 5;">
          <div class="circle">4</div>
          <div class="label">BIO 101<br>Biology I</div>
        </div>
        
        <div class="term-footer" style="grid-column: 2; grid-row: 7;">Units: 16 | Complexity: 85</div>
    
        <!-- TERM 3 -->
        <div class="term-header" style="grid-column: 3;">Spring</div>
        <div class="course" id="engr102" style="grid-column: 3; grid-row: 2;">
          <div class="circle">4</div>
          <div class="label">ENGR 102<br>Design Lab</div>
        </div>
        <div class="course" id="ge3" style="grid-column: 3; grid-row: 3;">
          <div class="circle">4</div>
          <div class="label">GE 3<br>Humanities</div>
        </div>
        <div class="course" id="math102" style="grid-column: 3; grid-row: 5;">
          <div class="circle">4</div>
          <div class="label">MATH 102<br>Calculus II</div>
        </div>
        
        <div class="term-footer" style="grid-column: 3; grid-row: 7;">Units: 12 | Complexity: 70</div>
        <!-- TERM 4 -->
        <div class="term-header" style="grid-column: 4;">Summer</div>
        <div class="course" id="stat201" style="grid-column: 4; grid-row: 2;">
          <div class="circle">4</div>
          <div class="label"><strong>STAT 201</strong><br>Probability</div>
        </div>
        <div class="course" id="ge4" style="grid-column: 4; grid-row: 3;">
          <div class="circle">4</div>
          <div class="label"><strong>GE 4</strong><br>Communication</div>
        </div>
        <div class="course" id="stat202" style="grid-column: 4; grid-row: 5;">
          <div class="circle">4</div>
          <div class="label">STAT 202<br>Inferential Stats</div>
        </div>
        
        <div class="term-footer" style="grid-column: 4; grid-row: 7;">Units: 12 | Complexity: 65</div>
      
        <!-- TERM 5 -->
        <div class="term-header" style="grid-column: 5;">Fall Y2</div>
        <div class="course" id="math201" style="grid-column: 5; grid-row: 2;">
          <div class="circle">4</div>
          <div class="label"><strong>MATH 201</strong><br>Linear Algebra</div>
        </div>
        <div class="course" id="cs201" style="grid-column: 5; grid-row: 3;">
          <div class="circle">4</div>
          <div class="label"><strong>CS 201</strong><br>Data Structures</div>
        </div>
        <div class="course" id="cs220" style="grid-column: 5; grid-row: 5;">
          <div class="circle">4</div>
          <div class="label">CS 220<br>Databases</div>
        </div>
        
        <div class="term-footer" style="grid-column: 5; grid-row: 7;">Units: 12 | Complexity: 80</div>
        <!-- TERM 6 -->
    <div class="term-header" style="grid-column: 6;">Winter Y2</div>
    <div class="course" id="cs202" style="grid-column: 6; grid-row: 2;">
      <div class="circle">4</div>
      <div class="label">CS 202<br>Algorithms</div>
    </div>
    <div class="course" id="ge5" style="grid-column: 6; grid-row: 3;">
      <div class="circle">4</div>
      <div class="label">GE 5<br>Society</div>
    </div>
    <div class="course" id="cs221" style="grid-column: 6; grid-row: 5;">
      <div class="circle">4</div>
      <div class="label">CS 221<br>AI Concepts</div>
    </div>
    <div class="term-footer" style="grid-column: 6; grid-row: 7;">Units: 12 | Complexity: 90</div>
    
    <!-- TERM 7 -->
    <div class="term-header" style="grid-column: 7;">Spring Y2</div>
    <div class="course" id="engr201" style="grid-column: 7; grid-row: 2;">
      <div class="circle">4</div>
      <div class="label">ENGR 201<br>Systems Design</div>
    </div>
    <div class="course" id="math202" style="grid-column: 7; grid-row: 3;">
      <div class="circle">4</div>
      <div class="label">MATH 202<br>Differential Eq.</div>
    </div>
    <div class="course" id="math230" style="grid-column: 7; grid-row: 5;">
      <div class="circle">4</div>
      <div class="label">MATH 230<br>Discrete Math</div>
    </div>
    <div class="term-footer" style="grid-column: 7; grid-row: 7;">Units: 12 | Complexity: 95</div>
    
    <!-- TERM 8 -->
    <div class="term-header" style="grid-column: 8;">Fall Y3</div>
    <div class="course" id="capstone" style="grid-column: 8; grid-row: 2;">
      <div class="circle">4</div>
      <div class="label">CAPSTONE<br>Project</div>
    </div>
    <div class="course" id="ge6" style="grid-column: 8; grid-row: 3;">
      <div class="circle">4</div>
      <div class="label">GE 6<br>Global Studies</div>
    </div>
    <div class="course" id="ethics300" style="grid-column: 8; grid-row: 5;">
      <div class="circle">4</div>
      <div class="label">ETHICS 300<br>Engineering Ethics</div>
    </div>
    <div class="term-footer" style="grid-column: 8; grid-row: 7;">Units: 12 | Complexity: 100</div>
    
      </div>    
    </div>
  
    <div class="key">
      <h3>Key</h3>
      <ul>
        <li><span class="circle example">4</span> = Course Units</li>
        <li><span class="key-line prereq"></span> Prerequisite</li>
        <li><span class="key-line blocked"></span> Directly Blocked</li>
        <li><span class="key-line all"></span> All Dependencies</li>
      </ul>
    </div>
  </div>

  <script>
    //Defines all connections between courses
    const arrows = [
      { from: 'math101', to: 'phys101' },
      { from: 'engr101', to: 'cs101' },
      { from: 'cs101', to: 'engr102' },
      { from: 'phys101', to: 'stat201' },
      { from: 'stat201', to: 'math201' },
      { from: 'cs101', to: 'cs201' },
      { from: 'math201', to: 'cs202' },
      { from: 'cs201', to: 'cs202' },
      { from: 'cs202', to: 'engr201' },
      { from: 'math202', to: 'capstone' },
      { from: 'engr201', to: 'capstone' },
      { from: 'math101', to: 'math102' },
      { from: 'math102', to: 'stat202' },
      { from: 'stat202', to: 'cs220' },
      { from: 'cs220', to: 'cs221' },
      { from: 'cs221', to: 'capstone' },
      { from: 'math102', to: 'math202' },
      { from: 'math101', to: 'math230' },
      { from: 'math230', to: 'cs221' },
    ];

    //Draws one curved SVG arrow between two course circles
    function drawArrow(fromId, toId) {
        const svg = document.getElementById('svg');
        const fromCircle = document.querySelector(`#${fromId} .circle`);
        const toCircle = document.querySelector(`#${toId} .circle`);
        const svgRect = svg.getBoundingClientRect();

        const from = fromCircle.getBoundingClientRect();
        const to = toCircle.getBoundingClientRect();

        const startX = from.right - svgRect.left;
        const startY = from.top + from.height / 2 - svgRect.top;

        const endX = to.left - svgRect.left;
        const endY = to.top + to.height / 2 - svgRect.top;

        const curveY = 30; //makes it subtler or more pronounced
        const dx = endX - startX;
        const curveX = Math.max(40, Math.min(dx / 2, 80)); // horizontal curve

        const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
        path.setAttribute("class", "arrow");
        path.setAttribute("d",`M ${startX} ${startY} C ${startX + curveX} ${startY - curveY}, ${endX - curveX} ${endY - curveY}, ${endX} ${endY}`);        
        // Store the source course ID so we can highlight it later
        path.dataset.from = fromId;
        path.dataset.to = toId;

        svg.appendChild(path);
        }
    //Clears and redraws all arrows, and adds hover listeners
    function renderArrows() {
        const svg = document.getElementById('svg');
        const grid = document.getElementById('curriculum');
        const gridRect = grid.getBoundingClientRect();

        svg.setAttribute('width', grid.scrollWidth);
        svg.setAttribute('height', grid.scrollHeight);
        //Remove all existing arrows from the SVG
        svg.querySelectorAll('.arrow').forEach(e => e.remove()); 
        //Loop through arrow list and draw each one
        arrows.forEach(({ from, to }) => {drawArrow(from, to);});
        //Add hover event listeners for interactivity
        document.querySelectorAll('.course').forEach(el => {
                el.addEventListener('mouseenter', () => highlightArrows(el.id));
                el.addEventListener('mouseleave', clearHighlights);
            });
        //Add click listeners to all courses to show popup info
            document.querySelectorAll('.course').forEach(course => {
                course.addEventListener('click', (e) => {
                    e.stopPropagation();
                    showCourseInfo(course);
                });
                });
        //Hide popup if you click anywhere else on the page
            document.addEventListener('click', () => {
            document.getElementById('popup').style.display = 'none';
            });
    }
    //Highlights all arrows that start from a given course
    function highlightArrows(courseId) {
        const grid = document.getElementById('curriculum');
        grid.classList.add('dimmed');

        document.querySelectorAll('.arrow').forEach(path => {
            path.classList.remove('highlighted');
            if (path.dataset.from === courseId || path.dataset.to === courseId) {
            path.classList.add('highlighted');
            }
        });

        document.querySelectorAll('.course').forEach(el => {
            el.classList.remove('active');
            if (el.id === courseId) {
            el.classList.add('active');
            }
        });
    }
    //Removes all arrow highlights (when hover ends)
    function clearHighlights() {
        const grid = document.getElementById('curriculum');
        grid.classList.remove('dimmed');

        document.querySelectorAll('.arrow').forEach(path => {
            path.classList.remove('highlighted');
        });

        document.querySelectorAll('.course').forEach(el => {
            el.classList.remove('active');
        });
    }
    //Show popup box with course info (prereqs and dependencies)
    function showCourseInfo(course) {
        const id = course.id;
        const name = course.querySelector('.label')?.innerText.split('\n')[0] || id;

        const prereqs = arrows.filter(a => a.from === id).map(a => a.to);
        const dependsOn = arrows.filter(a => a.to === id).map(a => a.from);

        const lines = [];
        lines.push(`<strong>${name}</strong>`);
        if (prereqs.length) lines.push("• Prerequisite for: " + prereqs.join(", "));
        if (dependsOn.length) lines.push("• Depends on: " + dependsOn.join(", "));
        if (!prereqs.length && !dependsOn.length) lines.push("• No direct links");

        const popup = document.getElementById('popup');
        popup.innerHTML = lines.join("<br>");

        const rect = course.getBoundingClientRect();
        popup.style.left = `${rect.right + 10 + window.scrollX}px`;
        popup.style.top = `${rect.top + window.scrollY}px`;
        popup.style.display = 'block';
    }

    window.addEventListener('load', renderArrows);
    window.addEventListener('resize', renderArrows);
  </script>
</body>
</html>
